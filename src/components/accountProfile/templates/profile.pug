-
  var auth = require('consts/auth/user.json');
  var rolesConsts = require('consts/team_member/roles.json');
  var countryDirective = require('directives/country/index.js');
  var ssnDirective = require('directives/ssn/index.js');
  var imageDropzone = require('directives/setdropzone/image.js'); 

  pug_html += app.breadcrumbs('Profile', '', [ ['Home', '/'], ['Profile', ''],]);

.container.profile.pt-50
  .row
    aside.col-xl-3.col-lg-4.m-b-1
      form(method="post" action="").form.form-section
        h4.m-t-0.m-b-1.profile-user-name.text-xs-center.text-uppercase #{user.first_name + ' ' + user.last_name}
        -
          pug_html += new imageDropzone.ImageDropzone({model: user.data}, 
            'image_image_id', 
            'image_data', 
            view.fields.image_image_id
          ).render().resultHTML;
      .row.m-t-2.m-b-2
        .col-xl-12.col-lg-12.col-md-6.offset-md-3.col-xs-8.offset-xs-2.offset-xl-0.offset-lg-0.p-l-0.p-r-0
          -
            var roles = app.user.getRoles();
            var company = app.user.getCompany();
          if roles && roles.length
            each roleInfo, idx in roles
              .profile-type-user
                if roleInfo.roles && roleInfo.roles.length
                  each role in roleInfo.roles
                    span.user-type #{ role.title }
                  .user-company
                    | in
                    a(href=app.getIssuerDashboardUrl(roleInfo.company.id)).link-3  #{ roleInfo.company.name }
                    |  company.
                  hr
          else if company && company.name
            .profile-type-user
              .user-company
                a(href="/dashboard/" + company.formc_id + "/issuer-dashboard").link-3  #{ company.name }
                |  company.
          if user.credit > 0
            .profile-type-user.credit-all.m-t-2
              
              h3.text-uppercase.m-t-0 your credit
                .small-text Credit valid for #{user.days_left} days.
              .profile-comission
                .wrap
                  h2.m-t-0.m-b-0 $#{user.credit}
              .text-xs-center
                a(href="/companies").btn.btn-secondary invest
              hr.m-t-2
          a(href="/account/change-password").link-3
            i.fa.fa-lock
            |  Need to change your password?
    .col-xl-8.col-lg-8
      ul.nav.nav-tabs.profile-tabs
        li(aria-expanded="false").nav-item
          a(
            href="#account_info"
            data-toggle="tab"
            aria-expanded="true"
            role="tab"
            class=tab === 'account_info'? 'active' : ''
          ).nav-link.uppercase Profile information
        li.nav-item
          a(
            href="#financial_info"
            data-toggle="tab"
            role="tab"
            aria-expanded="true"
            class=tab === 'financial_info'? 'active' : ''
          ).nav-link.uppercase Financial information

      .tab-content.profile-tabs-content.mt30

        div(
          aria-expanded="true"
          class=tab === 'account_info'? 'active in' : ''
        )#account_info.tab-pane.fade
          div
            section.form-section.clearfix
              form(method="post" action="").form
                .form-body.clearfix
                  .col-xs-12.p-xs-0
                    section.right-block
                      .form-group.row.required
                        label.col-xl-3.text-lg-right.text-xs-left Legal Name
                          span.color-red *
                        .col-xl-9
                          .row
                            -
                              pug_html += app.fields.fieldText('first_name', {
                                'class': 'col-lg-6 m-b-md-25',
                                'placeholder': 'First Name',
                                'value': user.first_name,
                              });
                              pug_html += app.fields.fieldText('last_name', {
                                'class': 'col-lg-6',
                                'placeholder': 'Last Name',
                                'value': user.last_name,
                              });
                      | !{ countryDirective(this).render() }
                      .row
                        .col-xl-12
                          .border-bottom.m-t-2.m-b-3
                      .row.m-b-0
                        .col-xl-6.col-lg-6
                          -
                            pug_html += app.fields.textLabel("twitter", _.extend({
                                'class1': 'col-xl-6 col-lg-12 text-lg-left text-xl-right',
                                'class2': 'col-xl-6 col-lg-12 input-min-width',
                                'type': 'text',
                                'value': user.twitter,
                              }, fields.twitter))
                        .col-xl-6.col-lg-6
                          -
                            pug_html += app.fields.textLabel("facebook", _.extend({
                                'class1': 'col-xl-5 col-lg-12 text-lg-left text-xl-right p-t-0 m-b-0 m-b-lg-1',
                                'class2': 'col-xl-7 col-lg-12',
                                'type': 'text',
                                'value': user.facebook,
                              }, fields.facebook))
                      .row.m-b-0
                        .col-xl-6.col-lg-6
                          -
                            pug_html += app.fields.textLabel("instagram", _.extend({
                                'class1': 'col-xl-6 col-lg-12 text-lg-left text-xl-right',
                                'class2': 'col-xl-6 col-lg-12 input-min-width',
                                'type': 'text',
                                'value': user.instagram,
                              }, fields.instagram))
                        .col-xl-6.col-lg-6
                          -
                            pug_html += app.fields.textLabel("linkedin", _.extend({
                                'class1': 'col-xl-5 col-lg-12 text-lg-left text-xl-right p-t-0 m-b-0 m-b-lg-1',
                                'class2': 'col-xl-7 col-lg-12',
                                'type': 'text',
                                'value': user.linkedin,
                              }, fields.linkedin))

                      .form-group.row.clearfix.m0
                        .col-lg-12.text-xs-center.m-t-2
                          .controls
                            button(
                              type="button"
                              data-method="PATCH"
                            )#saveAccountInfo.btn.btn-primary.pull-lg-right Save

        div(
          aria-expanded="true"
          class=tab === 'financial_info'? 'active in' : ''
        )#financial_info.tab-pane.fade
          div
            section.form-section.clearfix
              form(method="post" action="")
                .form-body.clearfix

                  .col-xl-12.p-xs-0
                    section.right-block
                      .form-group.row
                        .col-lg-12
                          .warning-block.m-b-0
                            i.fa.fa-info-circle
                            span.warning-text
                              | We are required by the SEC to collect this information in order to determine how much you can invest and what offerings will be available to you.
                      .form-group.row.bootstrap-slider-custom
                        .col-xl-12
                          label.m-b-2 My Net Worth
                        .col-xl-12
                          input(
                          type='text'
                          name="net_worth"
                          data-slider-value=user.net_worth
                          ).form-control.slider-net-worth
                      .form-group.row.bootstrap-slider-custom
                        .col-xl-12
                          label.m-b-2.m-t-1 My Annual Income
                        .col-xl-12.custom-annual-income
                          input(
                          type='text'
                          name="annual_income"
                          data-slider-value=user.annual_income
                          ).form-control.slider-annual-income
                      .radio-input
                        p.font-weight-bold.d-inline-block.m-b-1.m-t-1 Are you an Accredited Investor?&nbsp;
                          div.d-inline-block
                            div.showPopover.hidden-xs-down(data-content="An accredited investor is a natural person who has individual net worth, or joint net worth with the persons spouse, that exceeds $1mm at the time of the purchase, excluding the value of the primary residence of such person; or a natural person with income exceeding $200k in each of the two most recent years or joint income with a spouse exceeding $300k for those years and a reasonable expectation of the same income level in the current year.")
                              i(aria-hidden="true").fa.fa-question-circle.text-muted



                      .form-group.m-t-1
                        label.accredited_investor.shown-yes
                          input(
                            type="checkbox"
                            data-name="accredited_investor_1m"
                            value='1'
                            checked=user.accredited_investor_1m
                          ).col-xl-1.investor-1m.investor-item-checkbox
                          input(
                            type="hidden"
                            name="accredited_investor_1m"
                            value=String(user.accredited_investor_1m)
                          )
                          span.font-weight-normal.col-xl-10.p-l-0
                            | I am an Accredited Investor because my net worth, or joint net worth with my spouse, exceeds $1 million excluding my primary residence.
                        label.accredited_investor.shown-yes
                          input(
                            type="checkbox"
                            data-name="accredited_investor_200k"
                            value='1'
                            checked=user.accredited_investor_200k
                          ).col-xl-1.investor-200k.investor-item-checkbox
                          input(
                            type="hidden"
                            name="accredited_investor_200k"
                            value=String(user.accredited_investor_200k)
                          )
                          span.font-weight-normal.col-xl-10.p-l-0 I am an Accredited Investor because my annual income exceeds $200,000 or my joint annual income with my spouse exceeds $300,000 for each of the past two (2) years and expect the same this year
                        label.accredited_investor.shown-yes
                          input(
                            type="checkbox"
                            data-name="accredited_investor_5m"
                            value='1'
                            checked=user.accredited_investor_5m
                          ).col-xl-1.investor-entity.investor-item-checkbox
                          input(
                            type="hidden"
                            name="accredited_investor_5m"
                            value=String(user.accredited_investor_5m)
                          )
                          span.font-weight-normal.col-xl-10.p-l-0 I am an Accredited Investor because I am authorized to invest on behalf of an entity with at least $5M in assets or an entity where all of the owners are Accredited Investors.
                        label.accredited_investor.shown-yes
                          input(
                            type="checkbox"
                            data-name="accredited_investor_poor"
                            value='1'
                            checked=user.accredited_investor_poor
                          ).col-xl-1.investor-risk-agree.investor-item-checkbox
                          input(
                            type="hidden"
                            name="accredited_investor_poor"
                            value=String(user.accredited_investor_poor)
                          )
                          span.font-weight-normal.col-xl-10.p-l-0 I am an Accredited Investor because I am authorized to invest on behalf of a trust with at least $5M in assets and I acknowledge that I have sufficient knowledge to evaluate the merits and risks of private offerings.
                        .row
                          label.accredited_investor.shown-yes.col-xl-12
                            input(
                              type="checkbox"
                              checked=!user.accredited_investor_choice
                            ).col-xl-1.investor-risk-agree#not-qualify
                            span.font-weight-normal.col-xl-11.p-l-0 I do not qualify.
                            input(
                              type="hidden"
                              name="accredited_investor_choice"
                              value=String(user.accredited_investor_choice)
                            )

                      .row
                        .col-sm-12
                          hr.m-b-3.m-t-1
                      -
                        pug_html += app.fields.textLabel('bank_name', _.extend({
                            'type': 'text',
                            'value': user.bank_name
                          }, fields.bank_name))

                        pug_html += app.fields.textLabel('name_on_bank_account', _.extend({
                            'type': 'text',
                            'class1': 'col-xl-3 col-lg-12 text-xl-right text-lg-left m-b-0 p-t-0 m-b-lg-1',
                            'value': user.name_on_bank_account
                          }, fields.name_on_bank_account))

                        pug_html += app.fields.textLabel('account_number', _.extend({
                            'help_text': '<img src=' + require('images/routing-number-on-check.png') + '>',
                            'type': 'text',
                            'value': user.account_number
                          }, fields.account_number))

                        pug_html += app.fields.textLabel('account_number_re', _.extend({
                            'class1': 'col-xl-3 col-lg-12 text-xl-right text-lg-left m-b-0 p-t-0 m-b-lg-1',
                            'help_text': '<img src=' + require('images/routing-number-on-check.png') + '>',
                            'type': 'text',
                            'value': user.account_number
                          }, fields.account_number_re))

                        pug_html += app.fields.textLabel('routing_number', _.extend({
                            'help_text': '<img src=' + require('images/routing-number-on-check.png') + '>',
                            'type': 'text',
                            'value': user.routing_number
                          }, fields.routing_number))

                        pug_html += app.fields.textLabel('routing_number_re', _.extend({
                            'help_text': '<img src=' + require('images/routing-number-on-check.png') + '>',
                            'type': 'text',
                            'class1': 'col-xl-3 col-lg-12 text-xl-right text-lg-left m-b-0 p-t-0 m-b-lg-1',
                            'value': user.routing_number
                          }, fields.routing_number_re))

                      .form-group.row.radio.requried
                        label.text-xl-right.text-lg-left.col-xl-3.col-lg-12 Account Type
                          span.color-red *
                        .col-xl-9.col-lg-12.radio-input
                          label
                            input(
                              type="radio"
                              name='bank_account_type'
                              checked=(user.bank_account_type == auth.bank_account_type.Checking)
                              value=auth.bank_account_type.Checking
                            )
                            |  Checking
                          label
                            input(
                              type="radio"
                              name='bank_account_type'
                              checked=(user.bank_account_type == auth.bank_account_type.Savings)
                              value=auth.bank_account_type.Savings
                            )
                            |  Savings
                      .row
                        .col-xl-12
                          -
                            pug_html += ssnDirective(this).render();

                      .form-group.row.clearfix.m0
                        .col-lg-12.mt30.text-xs-center
                          .controls
                            button(
                              href="#"
                              data-method="PATCH"
                            )#saveFinancialInfo.btn.btn-primary.pull-lg-right SAVE
