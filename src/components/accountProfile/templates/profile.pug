include ../../../templates/mixins.pug
include ../../../templates/fields_mixins.pug

+breadcrumbs('Profile', '',
  [
    ['Home', '/'],
    ['Profile', '']
  ]
)


.container.profile.pt-50
  .row
    aside.col-xl-3.m-b-1
      form(method="post" action="").form.form-section
        - var values = user;
        h3.m-t-0.m-b-1.profile-user-name.text-xl-left.text-xs-center #{user.first_name + ' ' + user.last_name}
        +userProfileDropzone("image", _.extend({
          thumbSize: '255x135',
          default: '/img/default/255x153.png',
          icon: 'camera',
          text: 'Drop your profile photo here or click to upload',
          value: values.image_id,
        }, fields.image))
      .row.m-t-2
        .col-lg-12.text-xs-center
          a(href="/account/change-password").link-3 Need to change your password?

    .col-xl-9.col-lg-12
      ul.nav.nav-tabs.profile-tabs
        li(aria-expanded="false").nav-item
          a(href="#account_info" data-toggle="tab"  aria-expanded="true" role="tab").active.nav-link.uppercase Profile information
        li.nav-item
          a(
            href="#financial_info"
            data-toggle="tab"
            role="tab"
            aria-expanded="true").nav-link.uppercase Financial information

      .tab-content.profile-tabs-content.mt30

        div(aria-expanded="true")#account_info.tab-pane.fade.active.in
          .row
            section.form-section.clearfix
              form(method="post" action="").form
                .form-body.clearfix
                  .col-xs-12
                    section.right-block
                      .form-group.row.required
                        label.col-lg-3.text-lg-right.text-xs-left Legal Name
                          span.color-red *
                        +fieldText("first_name", {'class': 'col-lg-4 m-b-md-25','placeholder':'First Name' })
                        +fieldText("last_name", {'class': 'col-lg-4','placeholder':'Last Name' })

                      - user.country = 'US';
                      +fieldChoiceLabel("country", _.extend({
                        class1: 'col-lg-3 text-lg-right text-xs-left',
                        class2: 'col-lg-8',
                        empty: {'': 'Choose Country'},
                      }, fields.country))
                      +fieldTextLabel("street_address_1", _.extend({'class1': 'col-lg-3 text-lg-right text-xs-left', 'class2': 'col-lg-8 ', 'type': 'text'}, fields.street_address_1))
                      +fieldTextLabel("street_address_2", _.extend({'class1': 'col-lg-3 text-lg-right text-xs-left', 'class2': 'col-lg-8 ', 'type': 'text'}, fields.street_address_2))
                      .row.us-row(style="display:" + (user.country == 'US' ? 'block' : 'none'))
                        input(type="hidden" name="city" values=values['city'] disabled=((user.country=='US') ? false : true))
                        input(type="hidden" name="state" value=values['state'] disabled=((user.country=='US') ? false : true))
                        .col-md-12.col-lg-6
                          if user.country == 'US'
                            +fieldTextLabel('zip_code', _.extend({'class1': 'col-lg-6 text-lg-right text-xs-left', 'class2': 'col-lg-6', 'type': 'text', 'value': user.zip_code}, fields.zip_code))
                          else
                            +fieldTextLabel('zip_code', _.extend({'class1': 'col-lg-6', 'class2': 'col-lg-6', 'type': 'text', disabled: true }, fields.zip_code))

                        .col-lg-5.city_states.required
                          .row
                            label.col-lg-5.col-xs-6.text-lg-right.text-xs-left City/State
                            .col-lg-6.col-xs-6
                              a(data-toggle="modal" data-target="#city_state_modal" href="#city_state_modal").change_state_city
                                span.input-value.js-city-state #{ values['city'] ? values['city'] : '(City)' }, #{ values['state'] ? values['state'] : '(State)' }
                                i.fa.fa-pencil-square-o.link-1

                      .row.foreign-country-row(style="display:" + (user.country == 'US' ? 'none' : 'block'))
                        .col-lg-6
                          if user.country == 'US'
                            +fieldTextLabel('city', _.extend({'class1': 'col-lg-6 ', 'class2': 'col-lg-6 ', 'type': 'text', disabled: true}, fields.city))
                          else
                            +fieldTextLabel('city', _.extend({'class1': 'col-lg-6 ', 'class2': 'col-lg-6 ', 'type': 'text', 'value': user.city}, fields.city))
                        .col-lg-5
                          .form-group.row.state.text
                            label.text-lg-right.col-lg-5(for="state").p-t-0.m-b-0 State/Province/ Region
                            div.col-lg-7
                              input.form-control(name='state' placeholder='State/Province/Region' type="text" value=user.state)
                      .row.foreign-country-row(style="display:" + (user.country == 'US' ? 'none' : 'block'))
                        .col-lg-6
                          .form-group.row.zip_code.text
                            label.text-lg-right.col-lg-6(for="zip_code") Postal Code
                            div.col-lg-6
                              input.form-control(name='zip_code' placeholder='Postal Code' type="text" value=user.zip_code)
                        .col-lg-5
                          +fieldTextLabel('phone', _.extend({'class1': 'col-lg-5 ', 'class2': 'col-lg-7 ', 'type': 'text', 'value': user.phone }, fields.phone))

                      .form-group.row.clearfix.m0
                        .col-lg-11.mt30.text-xs-center
                          .controls
                            button(type="submit").btn.btn-primary.pull-lg-right SAVE

        div(aria-expanded="true")#financial_info.tab-pane.fade
          .row
            section.form-section.clearfix.col-xl-12
              form(method="post" action="")
                .form-body.clearfix
                  
                  .col-xs-12
                    section.right-block
                      .form-group.row
                        .col-lg-11
                          .warning-block.m-b-0
                            i.fa.fa-exclamation-triangle
                            span.warning-text
                              | Please confirm your identity and investor status. We are required by the SEC to review this information in order to determine how much you can invest and what offerings will be available to you.
                      .form-group.row.bootstrap-slider-custom
                        .col-xl-11
                          label.m-b-2 Annual Income
                        .col-xl-11
                          input(
                          type='text'
                          data-slider-value= 100
                          data-slider-ticks="[0, 50, 100, 200, 500, 1000, 2000, 5000]",
                          ticks_positions="[0, 14, 28, 42, 56, 70, 85, 100]",
                          data-slider-ticks-labels="['$0', '$50K', '$100K', '$200K', '$500K' , '$1M', '$2M', '$5M+']",
                          name="Annual_Income"
                          data-model-value='taxRate').form-control.js-bootstrap-slider-annual
                      .form-group.row.bootstrap-slider-custom
                        .col-xl-11
                          label.m-b-2 Net Worth
                        .col-xl-11
                          input(
                          type='text',
                          data-slider-value= 50,
                          name="taxRate",
                          data-slider-ticks="[0, 50, 100, 200, 500]",
                          ticks_positions="[0, 30, 60, 70, 90, 100]",
                          data-slider-ticks-labels="['$0', '$50K', '$100K', '$200K', '$500K']",
                          data-model-value='taxRate').form-control.js-bootstrap-slider

                      +fieldTextLabel('bank_name', _.extend({'class1': 'col-lg-3 text-lg-right text-xs-left', 'class2': 'col-lg-8 ', 'type': 'text', 'value': user.bank_name}, fields.bank_name))
                      +fieldTextLabel('name_on_bank_account', _.extend({'class1': 'col-lg-3 text-lg-right text-xs-left', 'class2': 'col-lg-8 ', 'type': 'text', 'value': user.name_on_bank_account}, fields.name_on_bank_account))
                      +fieldTextLabel('account_number', _.extend({'class1': 'col-lg-3 text-lg-right text-xs-left', 'class2': 'col-lg-8 ', 'type': 'text', 'value': user.account_number}, fields.account_number))
                      +fieldTextLabel('account_number_re', _.extend({'class1': 'col-lg-3 text-lg-right text-xs-left', 'class2': 'col-lg-8 ', 'type': 'text', 'value': user.account_number_re}, fields.account_number_re))
                      +fieldTextLabel('routing_number', _.extend({'class1': 'col-lg-3 text-lg-right text-xs-left', 'class2': 'col-lg-8 ', 'type': 'text', 'value': user.routing_number}, fields.routing_number))
                      .form-group.row.radio.requried
                        label.text-md-right.col-lg-3 Account Type
                          span.color-red *
                        .col-lg-9.radio-input
                          label
                            input(type="radio" name='account_type')
                            |  Checking
                          label
                            input(type="radio" name='account_type')
                            |  Savings
                      .row
                        .col-sm-11
                          hr.m-b-3.m-t-1

                      .form-group.row
                        .col-lg-11
                          .warning-block.m-b-0
                            i.fa.fa-exclamation-triangle
                            span.warning-text
                              | Investors are limited to 12 month investment totals ranging from $2,000 - $100,000 based on income and net worth. Please update your financial information to see your limit.

                      +fieldTextLabel('annual_income', _.extend({'class1': 'col-lg-3 text-lg-right text-xs-left', 'class2': 'col-lg-8 ', 'type': 'text', 'value': user.annual_income}, fields.annual_income))
                      +fieldTextLabel('net_worth', _.extend({'class1': 'col-lg-3 text-lg-right text-xs-left', 'class2': 'col-lg-8 ', 'type': 'text', 'value': user.net_worth}, fields.net_worth))

                      .form-group.row.clearfix.m0
                        .col-lg-11.mt30.text-xs-center
                          .controls
                            button(type="submit").btn.btn-primary.pull-lg-right SAVE

  .popover-content-ssn
    i.fa.fa-info-circle
    span Why do we need this? I know it seems terribly invasive but we are required to obtain your socialsecurity number for two reasons,
    p 1) regulators require we comply with know your customer and anti-money laundering rules and;
    p 2) companies will need to provide you with tax information based on your investment.
    p Don’t worry, we’re obsessive about your privacy.

//MODAL
div(tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true")#city_state_modal.modal.fade
  div(role="document").modal-dialog
    .modal-content
      .modal-header
        button(type="button" data-dismiss="modal" aria-label="Close").close
          span(aria-hidden="true")
            i.fa.fa-times
        h2.text-xs-center.text-uppercase.dosis.modal-title City/State

      .modal-body
        .container.form-section
          form.col-lg-10.offset-lg-1.border-bottom
            .form-group.row.clearfix.required
              input(type="text" placeholder="City" value=values['city'])#city.js-city.form-control
            .form-group.row.clearfix.required
              select(name='state')#state.js-state.form-control.custom-select
                option(checked='checked', value="") State
                each state in states
                  if state.abbreviation == values.state
                    option(value=state.abbreviation selected)= state.name
                  else
                    option(value=state.abbreviation)= state.name
            .form-group.row.clearfix.required.m0
              .row
                .col-lg-12
                  .col-lg-12.text-xs-center
                    button.btn.btn-primary.text-uppercase save
        .modal-footer

script(src= window.location.protocol + "//maps.google.com/maps/api/js?language=en&key=" + googleMapKey)
