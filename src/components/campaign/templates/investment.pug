include ../../../templates/mixins.pug
include ../../../templates/fields_mixins.pug

+breadcrumbs('Invest', '', 
  [
    ['Home', '/'], 
    ['Explore', ''],  
    [values.name, ''], 
    ['Invest in ' + values.name, '']
  ]
)
mixin fieldInput(name, attr)
  - attr = attr ? attr : fields[name];
  - attr.value = attr.value ? attr.value : values ? values[name] : '';
  div(class=attr.class)
    input(
            id=attr.id || name
            name=attr.name || name
            placeholder=attr.placeholder ? attr.placeholder :attr.label
            type=attr.type ? attr.type : 'text'
            class=(attr.help_text ? 'showPopover' : '') 
            data-content=(attr.help_text ?attr.help_text : '')
            value=attr.value
            maxlength = attr.maxlength ? attr.maxlength : false
            disabled=(attr.disabled ? attr.disabled : false)).form-control

.container.investment
  //START LEFT BLOCK
  .row
    .col-lg-8
      h2.text-uppercase.dosis.m-t-0.text-md-center.text-sm-center.text-xs-center.text-lg-left Investment
      .form-section.clearfix
        form(action="POST" data-method="POST").invest_form.clearfix
          input(type="hidden" name="company_id" value=values.id)
          .row
            .col-xl-12
              +fieldTextLabel("amount", _.extend({
                class1: 'col-lg-3 col-md-12 text-lg-left text-xl-right',
                class2: 'col-lg-4 col-md-12',
                placeholder: '$',
                text: "$10 of payment processing fee. Your money will be returned to you if the campaign doesn't reach the target goal ($500,000)."
                }, fields.amount))
          .row
            .col-xl-12
              +fieldTextLabel("fee", _.extend({
                class1: 'col-lg-3 col-md-12 text-lg-left text-xl-right',
                class2: 'col-lg-4 col-md-12 input-border-bottom',
                placeholder: '+ $10',
                value: '$10',
                disabled: true
                }, fields.fee))
          .row
            label.col-lg-3.text-lg-right.p-t-0.total-investment-label Total
            .col-lg-4
              span.p-l-1.total-investment-amount $10
          // popover content for amount field
          div.popover-content-amount-campaign
            i.fa.fa-info-circle
            p Investors are limited to 12 month investment totals ranging from $2,000 - $100,000 based on income and net worth.
            p Based on your annual income and net worth, you can invest 
              span(style="color:red;") only 
              | up to 
              span(style="color:red;") $:amount.
            br
            p Please 
              a(data-toggle="modal" data-target="#income_worth_modal" href="#income_worth_modal").update-income-worth update your annual income and net worth. 
          div.popover-content-rounding
            i.fa.fa-info-circle
            span Companies canâ€™t issue fractional shares.  The price per share is $#{values.campaign.price_per_share} so investment amounts must be a multiple of $#{values.campaign.price_per_share}.
          div.popover-content-minimum-investment
            i.fa.fa-info-circle
            span The minimum investment is $#{values.campaign.minimum_increment}.
          div.popover-content-amount-ok
            i.fa.fa-info-circle
            span Base on your updated annual income and net worth, you can invest $:amount.

          section.personal_information
            h2.text-uppercase.dosis.text-md-center.text-sm-center.text-xs-center.text-lg-left Personal Information
              span.small-text.open-sans Required by United States banking laws. This information is transmitted securely and will never be used for any purpose beyond executing your investment. You only have to do this once.
            .form-group.row
              label.col-lg-3.col-md-12.text-lg-right.text-xs-left.pull-xs-left Legal Name
                span.color-red *
              +fieldInput("personal_information_data[first_name]", {'class': 'col-lg-4-5 m-b-md-25 col-md-12','placeholder':'First Name', value: user.first_name })
              +fieldInput("personal_information_data[last_name]", {'class': 'col-lg-4-5 col-md-12 ','placeholder':'Last Name', value: user.last_name })
            .form-group.row
              label.col-lg-3.text-lg-right.text-xs-left Country
                span.color-red *
              .col-lg-9
                - if (!user.country) user.country = 'US';
                select(name="country").custom-select.w-100.country-select
                  each v, k in countries
                    option(value=k selected=(user.country == k)) #{v}
                  //- option(value="us" selected=(user.country == 'us')) United States
                  //- option(value="ua" selected=(user.country == 'ua')) UA
                  //- option(value='ru' selected=(user.country == 'ru')) Russia
            +nestedTextLabel("personal_information_data", "street_address_1", {
              class1: 'col-lg-3 col-md-12 text-lg-left text-xl-right',
              class2: 'col-lg-9 col-md-12',            
              }, user)
            //- +fieldTextLabel("personal_information_data[street_address_2]", _.extend({
            //-   class1: 'col-lg-3 col-md-12 text-lg-left text-xl-right',
            //-   class2: 'col-lg-9 col-md-12',
            //-   value: user.street_address_2,
            //-   }, fields.personal_information_data.schema.street_address_2))
            +nestedTextLabel("personal_information_data", "street_address_2", {
              class1: 'col-lg-3 col-md-12 text-lg-left text-xl-right',
              class2: 'col-lg-9 col-md-12',
              }, user)
            // IF USA
            .row.us-fields(style="display:" + (user.country == 'US' ? "display" : "none") + ";")
              input(type="hidden" name="personal_information_data[state]" value="NY" disabled=(user.country != 'US')) 
              input(type="hidden" name="personal_information_data[city]" value="New York" disabled=(user.country != 'US')) 
              .col-lg-7.p-l-2.col-md-12
                //- +fieldTextLabel("personal_information_data[zip_code]", _.extend({
                //-   class1: 'col-lg-5 text-lg-left text-xl-right',
                //-   class2: 'col-lg-7',
                //-   disabled: (user.country != 'us'),
                //-   value: user.zip_codem,
                //-   }, fields.zip_code))
                +nestedTextLabel("personal_information_data", "zip_code", {
                  class1: 'col-lg-5 text-lg-left text-xl-right',
                  class2: 'col-lg-7',
                  disabled: (user.country != 'US'),
                  }, user)
              .col-lg-5.city_states.col-md-12
                label.col-lg-5.col-md-6.col-sm-6.col-xs-6 City/State
                  span.color-red *
                .col-lg-7.col-md-6.col-sm-6.col-xs-6
                  span(data-toggle="modal" data-target="#city_state_modal" href="#city_state_modal").change_state_city
                    span.input-value.js-city-state New York, NY
                      i.fa.fa-pencil-square-o
            // IF OTHER COUNTRY
            .other-countries-fields(style="display:" + (user.country == 'US' ? "none" : "display") + ";")
              .row
                .col-lg-6.p-l-0.p-r-0
                  //- +fieldTextLabel("personal_information_data[city]", _.extend({
                  //-   'class1': 'col-lg-6 text-lg-left text-xl-right',
                  //-   'class2': 'col-lg-6 p-r-0',
                  //-   disabled: (user.country == 'us'),
                  //-   value: user.city,
                  //-   }, fields.city))
                  +nestedTextLabel("personal_information_data", "city", {
                    'class1': 'col-lg-6 text-lg-left text-xl-right',
                    'class2': 'col-lg-6 p-r-0',
                    disabled: (user.country == 'US'),
                    }, user)
                .col-lg-6
                  .form-group.row.state.text
                    label.text-lg-right.col-lg-5(for="state").p-t-0.m-b-0 State/Province/<br>Region
                      span.color-red *
                    div.col-lg-7
                      input.form-control(name='personal_information_data[state]' placeholder='State/Province/Region' type="text" value=user.state disabled=(user.country == 'US'))
              .row
                .col-lg-6.p-l-0.p-r-0
                  .form-group.row.zip_code.text
                    label.text-lg-right.col-lg-6(for="zip_code") Postal Code
                      span.color-red *
                    div.col-lg-6.p-r-0
                      input.form-control(name='personal_information_data[zip_code]' placeholder='Postal Code' type="text" value=user.zip_code disabled=(user.country == 'US'))
                .col-lg-6
                  +fieldTextLabel("personal_information_data[phone]", _.extend({
                    'class1': 'col-lg-5 text-lg-left text-xl-right',
                    'class2': 'col-lg-7 ', 'type': 'text',
                    disabled: (user.country == 'US')
                    }, fields.phone))

          section.payment-information.border-bottom
            h2.text-uppercase.dosis.text-md-center.text-sm-center.text-xs-center.text-lg-left Payment information
            .form-group.row
              label.col-lg-3.text-lg-right.text-xs-left I Want to Pay Using
              .col-lg-9
                select(name="payment_information_type").custom-select.w-100.payment-type-select
                  option(value="0") Echeck (ACH)
                  option(value="1") Check
                  option(value="2") Wire
            //IF ECHECK
            //- I may need to add a value into the attr object to make sure proper data is populated.
            .echeck-fields.payment-fields
              //- +fieldTextLabel("payment_information_data[name_on_bank_account]", _.extend({
              //-   class1: 'col-lg-3 col-md-12 text-lg-left text-xl-right',
              //-   class2: 'col-lg-9 col-md-12',
              //-   value: user.name_on_bank_account,
              //-   }, fields.name_on_bank_account))
              +nestedTextLabel("payment_information_data", "name_on_bank_account", {
                class1: 'col-lg-3 col-md-12 text-lg-left text-xl-right',
                class2: 'col-lg-9 col-md-12',
                }, user)
              //- +fieldTextLabel("payment_information_data[account_number]", _.extend({
              //-   class1: 'col-lg-3 col-md-12 text-lg-left text-xl-right',
              //-   class2: 'col-lg-9 col-md-12',
              //-   value: user.account_number,
              //-   }, fields.account_number))
              +nestedTextLabel("payment_information_data", "account_number", {
                class1: 'col-lg-3 col-md-12 text-lg-left text-xl-right',
                class2: 'col-lg-9 col-md-12',
                }, user)
              +fieldTextLabel("payment_information_data[account_number_re]", _.extend({
                class1: 'col-lg-3 col-md-12 text-lg-left text-xl-right',
                class2: 'col-lg-9 col-md-12',
                value: user.account_number,
                }, fields.account_number_re))
              //- +fieldTextLabel("payment_information_data[routing_number]", _.extend({
              //-   class1: 'col-lg-3 col-md-12 text-lg-left text-xl-right',
              //-   class2: 'col-lg-9 col-md-12',
              //-   value: user.routing_number,
              //-   }, fields.routing_number))
              +nestedTextLabel("payment_information_data", "routing_number", {
                class1: 'col-lg-3 col-md-12 text-lg-left text-xl-right',
                class2: 'col-lg-9 col-md-12',
                }, user)
              .form-group.row.radio.check-fields
                label.text-md-right.col-lg-3 Account Type
                .col-lg-9.radio-input
                  label 
                    input(type="radio" name="payment_information_data[account_type]" value="0" checked=(user.account_type == 0))
                    |  Checking
                  label 
                    input(type="radio" name="payment_information_data[account_type]" value="1" checked=(user.account_type == 1))
                    |  Savings
            // IF CHECK
            .row.check-fields.payment-fields(style="display:none;")
              .col-lg-12
                .row
                  .col-lg-9.offset-lg-3
                    .row
                      .col-lg-6
                        span Please Pay to the Order of:
                      .col-lg-6
                        span.font-weight-bold GrowthFountain Capital LLC
                    .row
                      .col-lg-6
                        span In the Amount of: 
                      .col-lg-6
                        span.font-weight-bold.total-investment-amount $1100
                    .row.m-b-2
                      .col-lg-6
                        span Memo:
                      .col-lg-6
                        span.font-weight-bold Invest in #{values.name} 
                    .row.m-b-2
                      .col-lg-6
                        span And mail the check to: 
                      .col-lg-6
                        span.font-weight-bold GrowthFountain Capital LLC
                          br
                          | 79 Madison Ave, 5th Floor
                          br
                          | New York, NY 10016
            .row.wire-fields.payment-fields(style="display:none;")
              .col-lg-12
                .row
                  .col-lg-9.offset-lg-3
                    .row
                      .col-lg-6
                        span Please Send your Wire to:
                      .col-lg-6
                        span.font-weight-bold GrowthFountain Capital LLC
                    .row
                      .col-lg-6
                        span In the Amount of: 
                      .col-lg-6
                        span.font-weight-bold.total-investment-amount $1100
                    .row.m-b-2
                      .col-lg-6
                        span Memo:
                      .col-lg-6
                        span.font-weight-bold Invest in #{values.name} 
                        //- span.help-block (as indicated above)
                    .row.m-b-2
                      .col-lg-6
                        span Wire Instructions: 
                      .col-lg-6
                        span.font-weight-bold GrowthFountain Capital LLC
                          br
                          | 79 Madison Ave, 5th Floor
                          br
                          | New York, NY 10016
                          br
                          br
                          | Routing/ABA# 122287251
                          br
                          | Account# 200100086657

                          br
                          br
                          | BofI Federal Bank 
                          br
                          | 4350 La Jolla Village Drive, Suite 140
                          br
                          | San Diego, CA 92122
            //.col-md-12
              span.help-block GrowthFountain does not store your bank login credentials

          section.varification
            h2.text-uppercase.dosis.text-md-center.text-sm-center.text-xs-center.text-lg-left CONFIRMATION OF UNDERSTANDING
            .form-group.row
              .col-lg-2
                .row
                  .col-lg-6.col-md-6.col-sm-6.col-xs-6.text-lg-center
                    label.d-block.label-true-false TRUE
                    input(type="radio" value="true" name="is_reviewed_educational_material").d-block.m-x-auto
                  .col-lg-6.col-md-6.col-sm-6.col-xs-6.text-lg-center
                    label.d-block.label-true-false FALSE
                    input(type="radio" value="false" name="is_reviewed_educational_material").d-block.m-x-auto
                    
              .col-lg-10
                label I confirm and represent that (a) I have reviewed the educational material that has been made available on this website, (b) I understand that the entire amount of my investment may be lost and (c) I am in a financial condition to bear the loss of the investment and (d) I represent that I have not exceeded my investment limitations.
            .form-group.row
              .col-lg-2
                .row
                  .col-lg-6.col-md-6.col-sm-6.col-xs-6.text-lg-center
                    label.d-block.label-true-false TRUE
                    input(type="radio" value="true" name="is_understand_restrictions_to_cancel_investment").d-block.m-x-auto
                  .col-lg-6.col-md-6.col-sm-6.col-xs-6.text-lg-center
                    label.d-block.label-true-false FALSE
                    input(type="radio" value="false" name="is_understand_restrictions_to_cancel_investment").d-block.m-x-auto
                    
              .col-lg-10
                label I understand that there are restrictions on my ability to cancel an investment commitment and obtain a return of my investment.
            .form-group.row
              .col-lg-2
                .row
                  .col-lg-6.col-md-6.col-sm-6.col-xs-6.text-lg-center
                    label.d-block.label-true-false TRUE
                    input(type="radio" value="true" name="is_understand_difficult_to_resell_purchashed").d-block.m-x-auto
                  .col-lg-6.col-md-6.col-sm-6.col-xs-6.text-lg-center
                    label.d-block.label-true-false FALSE
                    input(type="radio" value="false" name="is_understand_difficult_to_resell_purchashed").d-block.m-x-auto
                    
              .col-lg-10
                label I understand that it may be difficult to resell securities purchased on GrowthFountain.
            .form-group.row
              .col-lg-2
                .row
                  .col-lg-6.col-md-6.col-sm-6.col-xs-6.text-lg-center
                    label.d-block.label-true-false TRUE
                    input(type="radio" value="true" name="is_understand_investing_is_risky").d-block.m-x-auto
                  .col-lg-6.col-md-6.col-sm-6.col-xs-6.text-lg-center
                    label.d-block.label-true-false FALSE
                    input(type="radio" value="false" name="is_understand_investing_is_risky").d-block.m-x-auto
                    
              .col-lg-10
                label I understand that investing in start-ups and small businesses listed on GrowthFountain is very risky, and that I should not invest any funds unless I can afford to lose my entire investment.
            .col-lg-12.m-t-2
              .row
                span By Signing You Acknowledge and Agree to the 
                  a(href="#" data-tpl="common_stock").link-2 Subscription Agreement
                  |  and 
                  a(href="#" data-tpl="revenue_share").link-2 Participation Agreement
            .col-lg-12.m-t-2
              .row
                .form-group.row
                  .col-lg-4
                    input(type="text" placeholder="Type Your Name").form-control.typed-name
                    .help-block Electronically Sign Here
                  .col-lg-4
                    .electronically
                      span.by By:
                      span.name.signature

            .form-group.row
              .col-md-12.text-md-center.text-sm-center.text-xs-center
                .controls
                  button(
                  type="submit").btn.btn-primary.pull-lg-right.text-uppercase invest
    //END LEFT BLOCK
    //START RIGHT BLOCK
    .col-lg-4.pull-right

      if values.campaign.perks
        h2.text-uppercase.dosis.m-t-0 PERKS
          span.small-text.open-sans Investor Perks are not intended to affect the value of the security and investors should evaluate the merits of each investment without regard to any Investor Perks.
        .list-group.list-group-border-invest.invest-right-margin
          - values.campaign.perks = Object.keys(values.campaign.perks).map(function(key) { return values.campaign.perks[key]; });
          - values.campaign.perks.sort(function (a, b) { return Number(b.amount) - Number(a.amount); });
          each v,k in values.campaign.perks
            a(href="#" data-amount=v.amount).list-group-item.list-group-item-action.perk
              h3.list-group-item-heading 
                span.text-color-puerto_rico $#{v.amount}
                |  Investments 
                i.fa.fa-check(style="display:none;")
              p.list-group-item-text.text-justify #{v.perk}
        
      h2.text-uppercase.dosis.text-md-center.text-sm-center.text-xs-center Investment Summary
      .jumbotron.jumbotron-fluid.investment-summary
        .container
          .col-md-7
            .row
              span Target
              p.font-weight-bold $#{values.campaign.minimum_raise.toLocaleString('en-US')} - $#{values.campaign.maximum_raise.toLocaleString('en-US')}
          .col-md-5
            .row
              span Committed
              p.font-weight-bold $2,256
        .container
          .col-md-7
            .row
              span Offering deadline
              p.font-weight-bold.m-b-0 Sep 14, 2016
          .col-md-5
            .row
              span Type of security
              p.font-weight-bold.m-b-0 #{values.campaign.security_type == 0 ? 'Common Equity' : 'Revenue Share'}

//MODAL
div(tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true")#city_state_modal.modal.fade
  div(role="document").modal-dialog
    .modal-content
      .modal-header
        button(type="button" data-dismiss="modal" aria-label="Close").close
          span(aria-hidden="true")
            i.fa.fa-times
        h2.text-lg-center.text-uppercase.dosis.modal-title City/State

      .modal-body
        .container.form-section
          form.col-lg-10.offset-lg-1.border-bottom
            .form-group.row.clearfix.required
              input(type="text" placeholder="City")#city.js-city.form-control
            .form-group.row.clearfix.required
              select(name='state')#state.js-state.form-control.custom-select
                option(checked='checked', value="") State
                each state in states
                  option(value=state.abbreviation)= state.name
            .form-group.row.clearfix.required.m0
              .row
                .col-lg-12
                  .col-lg-12.text-lg-center
                    button(data-dismiss="modal" type="button").update-location.btn.btn-primary.text-uppercase save
        .modal-footer
//MODAL
div(tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true")#income_worth_modal.modal.fade
  div(role="document").modal-dialog
    .modal-content
      .modal-header
        button(type="button" data-dismiss="modal" aria-label="Close").close
          span(aria-hidden="true")
            i.fa.fa-times
        h2.text-lg-center.text-uppercase.dosis.modal-title Annual Income/Net Worth

      .modal-body
        .container.form-section
          form.col-lg-10.offset-lg-1.border-bottom.update-income-worth
            div Your current limit is 
              b $
                span.current-limit 1000
              | .
            .form-group.row.clearfix.required
              label Annual Income
              input(type="text" placeholder="Annual Income" name="annual_income" value=(user.annual_income * 1000).toLocaleString('en-US'))#annual_income.annual_income.form-control
            .form-group.row.clearfix.required
              label Net Worth
              input(type="text" placeholder="Net Worth" name="net_worth" value=(user.net_worth * 1000).toLocaleString('en-US'))#net_worth.net-worth.form-control
            .form-group.row.clearfix.required.m0
              .row
                .col-lg-12
                  .col-lg-12.text-lg-center
                    button(data-dismiss="modal" type="button").btn.btn-primary.text-uppercase.submit-income-worth update
        .modal-footer

if !window.google || !window.google.maps
  script(src= window.location.protocol + "//maps.google.com/maps/api/js?language=en&key=" + googleMapKey)
