#machine:
#    node:
#        version:  6.2.1
dependencies:
    override:
        - nvm use 6
        - npm install
        - git submodule init
        - git submodule update
        - git submodule git pull origin master
        - ls -la 
        - ./node_modules/webpack/bin/webpack.js -p --config ./webpack.config.production.js 
        - ./node_modules/gulp/bin/gulp.js styles
        - sudo apt-get update
        - sudo apt-get install python-dev
        - sudo pip install awscli
        - ls -la dist
        - ./deploy.sh
        - export NODE_PATH="`pwd`/src"
    
    cache_directories:
        - "node_modules"

general:
    branches:
        ignore:
            - test

deployment:
    aws:
        branch: master
        commands:
            - ./deploy.sh
